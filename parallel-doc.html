<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Masaki Waga" />
  <title>The parallel package</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">The <code>parallel</code> package</h1>
<p class="author">Masaki Waga</p>
</header>
<p>This is a SATySFi package providing typesetting of two column texts in parallel. This package is inspired by the <a href="https://ctan.org/pkg/parallel">LaTeX package</a> with the same name.</p>
<h1 id="usage">Usage</h1>
<p>The following shows a small working example of <code>parallel</code> package.</p>
<pre class="satysfi"><code>@require: stdja
@import: ./parallel

StdJa.document (|
  title = {Example usage of parallel};
  author = {Masaki Waga};
  show-title = true;
  show-toc = false;
|) &#39;&lt; 
   +parallel &lt;
     +p {
       Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
       Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
       Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
       Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
     }
  &gt; &lt;
     +p {
       ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。
     }
  &gt;
&gt;
</code></pre>
<p>You can also specify the ratios of the columns as follows. We note that their sum should be smaller than 1.</p>
<pre class="satysfi"><code>@require: stdja
@import: ./parallel

StdJa.document (|
  title = {Example usage of parallel};
  author = {Masaki Waga};
  show-title = true;
  show-toc = false;
|) &#39;&lt; 
   +parallel ?:(0.7) ?:(0.28) &lt;
     +p {
       Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
       Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
       Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
       Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
     }
  &gt; &lt;
     +p {
       ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。ぞうの卵はおいしいぞう。
     }
  &gt;
&gt;
</code></pre>
<h1 id="dependency-packages">Dependency packages</h1>
<p><code>parallel</code> is independent of any external packages except for <code>pervasives</code> that is distributed with SATySFi.</p>
<h1 id="commands">Commands</h1>
<p>The parallel package provides only <code>+parallel</code> command. The signature of <code>+parallel</code> is as follows.</p>
<pre id="COMMANDS" class="satysfi"><code>direct +parallel : [float?; float?; block-text; block-text] block-cmd
</code></pre>
<p>The first and the second arguments of <code>+parallel</code> are the float values representing the ratios of the left and the right columns, respectively. These values are optional. The third and the forth arguments of <code>+parallel</code> are the contents of the left and the right columns, respectively.</p>
<h1 id="contributing">Contributing</h1>
<p>The original source code of this package is written in <code>parallel.org</code> and the distribution is generated by tangling it with GNU Emacs. If you want to make a pull request on GitHub, please modify this file.</p>
<p>It is also welcome to make an issue with a suggestion of improvement, bug fix, and so on.</p>
<h1 id="implementation">Implementation</h1>
<p>The following shows the implementation of the parallel package.</p>
<pre class="satysfi"><code>@require: pervasives

module Parallel : sig

  direct +parallel : [float?; float?; block-text; block-text] block-cmd
end = struct
    let-block ctx +parallel ?:left-ratio ?:right-ratio left-block right-block =
      let left-ratio = 
  match left-ratio with
  | None -&gt; 0.48
  | Some(left-ratio) -&gt; left-ratio in
      let right-ratio =
  match right-ratio with
  | None -&gt; 0.48
  | Some(right-ratio) -&gt; right-ratio in
      let left-column-width = (get-text-width ctx) *&#39; left-ratio in
      let right-column-width = (get-text-width ctx) *&#39; right-ratio in
      let margin = (get-text-width ctx) -&#39; left-column-width -&#39; right-column-width in
      let br-left-pbox =
  embed-block-top ctx left-column-width (fun ctx -&gt; read-block ctx left-block) in
      let br-right-pbox =
  embed-block-top ctx right-column-width (fun ctx -&gt; read-block ctx right-block) in
      form-paragraph ctx (br-left-pbox ++ (inline-skip margin) ++ br-right-pbox)
end
</code></pre>
</body>
</html>
